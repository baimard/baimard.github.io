.. _installation:

Installation de la solution
===========================

Standalone
**********

Pré-requis
----------

#. Docker : installeur `ici <https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script>`_ ``docker version`` pour vérifier

#. docker-compose : ``sudo apt install docker-compose`` ou ``pip3 install docker-compose`` ou `compose <https://docs.docker.com/compose/install/>`_

#. ``sudo apt install git``

Installation
------------

#. copie depuis votre repository git : ``git clone --branch env_preparation https://git.adacis.net/b.aimard/yubico.git``

#. Créer votre fichier .env
    .. code-block:: bash
        
        cd yubico
        #et mettre dans un fichier .env : 
        USERDB=otp
        PASSWORDDB=otp
        DATABASEIP=database
        DATABASE=otp

#. ``make new``
#. ``make start``

Haute Disponibilité
*******************

#. sur un premier serveur faire l'installation Standalone

#. sur un autre serveur copie depuis votre repository git : ``git clone --branch env_preparation https://git.adacis.net/b.aimard/yubico.git``

#. copier le fichier .env du premier serveur vers le serveur répliqué

#. copier le fichier keys.json dans depuis le répertoire init_ksm du serveur de référence dans le répertoire du serveur répliqué

#. faire la procédure de mise en HA de la base de données :ref:`bdd`

#. ``make start``